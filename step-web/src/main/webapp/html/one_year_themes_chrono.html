<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>One Year Themes Collected Chronologically</title>
    <link rel="shortcut icon" href="/images/step-favicon.ico"/>
    <link href="/css/bootstrap.css" rel="stylesheet" media="screen"/>
    <link href="/css/bootstrap-theme.min.css" rel="stylesheet" media="screen"/>
    <link href="/css/select2.css" rel="stylesheet" media="screen"/>
    <link href="/css/select2-bootstrap.css" rel="stylesheet" media="screen"/>
    <link href="/scss/step-template.css" rel="stylesheet" media="screen"/>
    <script src="/international/en..js" type="text/javascript"></script>
    <script src="/libs/jquery-1.10.2.min.js" type="text/javascript"></script>
    <script src="/libs/underscore-min.js" type="text/javascript"></script>
    <script src="/libs/bootstrap.min.js" type="text/javascript"></script>
    <script src="/libs/backbone.js" type="text/javascript"></script>
    <script src="/libs/backbone.localStorage.js" type="text/javascript"></script>
    <script src="/js/step_constants.js" type="text/javascript"></script>
    <script src="/js/passage_selection.js" type="text/javascript"></script>
    <script src="/js/search_selection.js" type="text/javascript"></script>
    <script src="/js/backbone/models/model_settings.js" type="text/javascript"></script>

    <style>
  
    .fixTableHead {
        overflow-y: auto;
    }
    .fixTableHead .tb_head {
        position: sticky;
        top: 0;
    }
    table {
        border-collapse: collapse;        
        width: 100%;
        font-family: Georgia, serif;
        font-size: 15px;
    }
    .tb_head {
        padding: 4px;
        margin: 3px;
        border: 2px solid #17758f;
        background: #17758f;
        color: white;
    }
    .th_col {
        padding: 4px;
        margin: 3px;
        border: 2px solid #17758f;
        background: #17758f;
        color: white;
    }
    .tb_col {
        padding: 4px;
        margin: 3px;
        border: 1px solid #ccc;
    }
    .clickable{
        color: #17758f;
        cursor: pointer;
    }
    .ind10{
        text-indent: -10px;
        padding-left: 10px;
    }
    .hTitle{
        font-family: Helvetica;
        font-size: 30px;
        font-weight: bold;
        border: none;
    }

    :root {
        --clrHighlight: #17758F;
        --clrHighlightBg: #17758F;
        --clrStrongText: #498090;
        --clrLexiconFocusBG: #c8d8dc;
        --clrRelatedWordBg: #b2e5f3;
        --clrBackground: #ffffff;
        --clrText: #5d5d5d;
        --clr2ndHover: #d3d3d3;
    }

    </style>
</head>
<body style="margin:0;background-color:white">
<div id="header">
<h2 class="hTitle">One Year Themes Collected Chronologically</h2>

<p>Based on the reading plans of Katherine Fedor at <a target="_blank" href="https://treasureinthebible.com">treasureinthebible.com</a>.  Used with permission.

</div>
<div class="fixTableHead">
<table id="plan">
<tbody id="tb_body">

</tbody>
</table>
<br>
</div>
<script>

(function() {
    var inIFrame = false;
    try {
        inIFrame = window.self !== window.top;
    } catch (e) {
        inIFrame = true;
    }
	var debugOption = "";
	var urlPart1 = window.location.origin;
	var pos = window.location.href.indexOf("/html/one_year_themes_chrono");
	if (pos > 8) { // probably running in development environment.
		urlPart1 = window.location.href.substr(0, pos);
		debugOption = "&debug";
	}

    if (window.innerWidth > 960) {
        if (!inIFrame)
            window.location = urlPart1 + "/html/split.html?" + urlPart1 + 
    			"/?q=reference=Gen.1" + 
    			debugOption + "&skipwelcome&secondURL=" + window.location.origin + window.location.pathname;

    }

	if (typeof jQuery == 'undefined') {
  		loadFile(urlPart1 + "/css/bootstrap.css");
		loadFile(urlPart1 + "/css/bootstrap-theme.min.css");
		loadFile(urlPart1 + "/css/select2.css");
		loadFile(urlPart1 + "/css/select2-bootstrap.css");
		loadFile(urlPart1 + "/scss/step-template.css");
		loadFile(urlPart1 + "/international/en.js");
		loadFile(urlPart1 + '/libs/jquery-1.10.2.min.js');
        loadFile(urlPart1 + '/libs/introjs.min.js');
		loadFile(urlPart1 + "/libs/underscore-min.js");
		loadFile(urlPart1 + "/libs/bootstrap.min.js");
		loadFile(urlPart1 + "/libs/backbone.js");
		loadFile(urlPart1 + "/libs/backbone.localStorage.js");
		loadFile(urlPart1 + "/js/backbone/models/model_settings.js");
		loadFile(urlPart1 + "/js/step_constants.js");
		loadFile(urlPart1 + "/js/passage_selection.js");
		loadFile(urlPart1 + "/js/search_selection.js");
		// Poll for jQuery to come into existance
		var checkReady = function(callback) {
			if (window.jQuery) {
				callback(jQuery);
			}
			else {
				window.setTimeout(function() { checkReady(callback); }, 200);
			}
		};
		// Start polling...
		checkReady(function($) {
			$(function() {
				setupTable(urlPart1);
			});
		});
	}
	else setupTable(urlPart1);
})();

function loadFile(path) {
  if (path.endsWith(".js")) {
    var fileref = document.createElement("script");
    fileref.setAttribute("type", "text/javascript");
    fileref.setAttribute("src", path);
  } else if (path.endsWith(".css")) {
    var fileref = document.createElement("link");
    fileref.setAttribute("rel", "stylesheet");
    fileref.setAttribute("type", "text/css");
    fileref.setAttribute("href", path);
  }
  else return;
  fileref.async = false;
  document.getElementsByTagName("head")[0].appendChild(fileref);
}

function setupTable(urlPart1) {
    var inIFrame = false;
    try {
        inIFrame = window.self !== window.top;
    } catch (e) {
        inIFrame = true;
    }

    if (inIFrame) {
        var tblHeadingHTLM = '	<colgroup>\n' + 
            '		<col span="1" style="width:10%;">\n' +
            '		<col span="1" style="width:15%;">\n' +
            '		<col span="1" style="width:15%;">\n' +
            '		<col span="1" style="width:15%;">\n' +
            '		<col span="1" style="width:15%;">\n' +
            '		<col span="1" style="width:15%;">\n' +
            '		<col span="1" style="width:15%;">\n' +
            '	</colgroup>\n' +
            '  <thead>\n' +
            '    <tr class="tb_head">\n' +
            '      <th class="th_col"></th>\n' +
            '      <th class="th_col">Sunday</th>\n' +
            '      <th class="th_col">Monday</th>\n' +
            '      <th class="th_col">Tuesday</th>\n' +
            '      <th class="th_col">Wednesday</th>\n' +
            '      <th class="th_col">Thursday</th>\n' +
            '      <th class="th_col">Friday</th>\n' +
            '    </tr>\n' +
            '  </thead>\n';
    }
    else {
        $(".hTitle").css("font-size", "24px");
        var tblHeadingHTLM = '	<colgroup>\n' + 
            '		<col span="1" style="width:20%;">\n' +
            '		<col span="1" style="width:80%;">\n' +
            '	</colgroup>\n' +
            '  <thead>\n' +
            '    <tr class="tb_head">\n' +
            '      <th class="th_col"></th>\n' +
            '      <th class="th_col">Readings</th>\n' +
            '    </tr>\n' +
            '  </thead>\n';
    }
    $("#plan").append(tblHeadingHTLM);

    var fullHeight = $(window).height();
    var remainingHeight = Math.floor((fullHeight - $("#header").height()) * 0.95);
    $(".fixTableHead").css("height", remainingHeight + "px");

    var settings = new SettingsModelList;
    settings.fetch();
    if (settings.length > 0) {
        var sz  =  15;
        step.settings = settings.at(0);
        sz = step.settings.get("defaultfont");
        $("table").css("font-size", sz + "px");
    }

    // set the year in the heading
    var table = document.getElementById("plan");
    var thead = table.getElementsByTagName("thead")[0];
    var th_rows = thead.getElementsByTagName("tr");
    var text = "";
    var year;
    var col1_day = 0;  // this reading list starts on a Sunday
    var col1_name = "Sun";

    today = new Date();
    year = today.getYear() + 1900;
    th_rows[0].cells[0].innerText = year;
    dat = new Date (year + '/01/01');
    while (dat.getDay() != col1_day) {
        dat.setDate(dat.getDate() + 1);
    }

	var jsonFileName = "readings_1yr_themes";

	var tblRowHTML = "";
    var pattern = "{[^}]+}";
    var pattern2 = /([0-9])[abcd]/g;
    var clickText1 = 'class="clickable" onclick=displayPassages(this,"';
    var clickText2 = '")>';
    var clickText3 = '</span>';

    $.getJSON(urlPart1 + "/html/json/" + jsonFileName + ".json", function(array) {
		for (var i = 0; i < array.length; i ++ ) {
            var col1 = array[i][0];
            var col2 = array[i][1];
            var col3 = array[i][2];
            var col4 = array[i][3];
            var col5 = array[i][4];
            var col6 = array[i][5];

            text = dat.toDateString().replace(col1_name,"").replace(" 0", " ");
            if (year == (dat.getYear() + 1900)) {
                text = text.replace(" " + year, "");
            }
            else {
                year = dat.getYear() + 1900;
                text = text.replace(" " + year, ",\n" + year);
            }
            dat.setDate(dat.getDate() + 7);

            // Add links to the passages, designated between { }.

            pos = col1.search(pattern);
            while (pos > -1) {
                clickText = "<span ";
                passage = RegExp.lastMatch;
                passage = passage.replace(/{/, '').replace(/}/, '');
                clickText += clickText1
                    + passage.replace(/ /g, '').replace(pattern2, '$1').replace(/\*/, '').replace(/\[1-[0-9]\]/, "")
                    + clickText2 + passage.replace(/;/g, '; ') + clickText3;
                col1 = col1.replace(/{[^}]+}/, clickText);
                pos = col1.search(pattern);
            }
            
            pos = col2.search(pattern);
            while (pos > -1) {
                clickText = "<span ";
                passage = RegExp.lastMatch;
                passage = passage.replace(/{/, '').replace(/}/, '');
                clickText += clickText1
                    + passage.replace(/ /g, '').replace(pattern2, '$1').replace(/\*/, '').replace(/\[1-[0-9]\]/, "")
                    + clickText2 + passage.replace(/;/g, '; ') + clickText3;
                col2 = col2.replace(/{[^}]+}/, clickText);
                pos = col2.search(pattern);
            }
            
            pos = col3.search(pattern);
            while (pos > -1) {
                clickText = "<span ";
                passage = RegExp.lastMatch;
                passage = passage.replace(/{/, '').replace(/}/, '');
                clickText += clickText1
                    + passage.replace(/ /g, '').replace(pattern2, '$1').replace(/\*/, '').replace(/\[1-[0-9]\]/, "")
                    + clickText2 + passage.replace(/;/g, '; ') + clickText3;
                col3 = col3.replace(/{[^}]+}/, clickText);
                pos = col3.search(pattern);
            }
            
            pos = col4.search(pattern);
            while (pos > -1) {
                clickText = "<span ";
                passage = RegExp.lastMatch;
                passage = passage.replace(/{/, '').replace(/}/, '');
                clickText += clickText1
                    + passage.replace(/ /g, '').replace(pattern2, '$1').replace(/\*/, '').replace(/\[1-[0-9]\]/, "")
                    + clickText2 + passage.replace(/;/g, '; ') + clickText3;
                col4 = col4.replace(/{[^}]+}/, clickText);
                pos = col4.search(pattern);
            }
            
            pos = col5.search(pattern);
            while (pos > -1) {
                clickText = "<span ";
                passage = RegExp.lastMatch;
                passage = passage.replace(/{/, '').replace(/}/, '');
                clickText += clickText1
                    + passage.replace(/ /g, '').replace(pattern2, '$1').replace(/\*/, '').replace(/\[1-[0-9]\]/, "")
                    + clickText2 + passage.replace(/;/g, '; ') + clickText3;
                col5 = col5.replace(/{[^}]+}/, clickText);
                pos = col5.search(pattern);
            }
            
            pos = col6.search(pattern);
            while (pos > -1) {
                clickText = "<span ";
                passage = RegExp.lastMatch;
                passage = passage.replace(/{/, '').replace(/}/, '');
                clickText += clickText1
                    + passage.replace(/ /g, '').replace(pattern2, '$1').replace(/\*/, '').replace(/\[1-[0-9]\]/, "")
                    + clickText2 + passage.replace(/;/g, '; ') + clickText3;
                col6 = col6.replace(/{[^}]+}/, clickText);
                pos = col6.search(pattern);
            }
            
            if (inIFrame) {
            	tblRowHTML = 
            		'<tr><td class="tb_col">' + text + '</td>' +
            		'<td class="tb_col">' + col1 + '</td>' +
            		'<td class="tb_col">' + col2 + '</td>' +
            		'<td class="tb_col">' + col3 + '</td>' +
            		'<td class="tb_col">' + col4 + '</td>' +
            		'<td class="tb_col">' + col5 + '</td>' +
            		'<td class="tb_col">' + col6 + '</td></tr>';
            }
            else {
            	tblRowHTML = 
            		'<tr><td class="tb_col">' + text + '</td>' +
            		'<td class="tb_col">' +
                        '<div class="ind10">Sun:  ' + col1 + '</div>' +
                        '<div class="ind10">Mon:  ' + col2 + '</div>' +
                        '<div class="ind10">Tue:  ' + col3 + '</div>' +
                        '<div class="ind10">Wed:  ' + col4 + '</div>' +
                        '<div class="ind10">Thu:  ' + col5 + '</div>' +
                        '<div class="ind10">Fri:  ' + col6 + '</div>' +
                    '</td></tr>';
            }
    	    $("#tb_body").append(tblRowHTML);
		}
    });

}


function displayPassages(item, string) {
    var inIFrame = false;
    try {
        inIFrame = window.self !== window.top;
    } catch (e) {
        inIFrame = true;
    }

	var urlPart1 = window.location.origin;

    if (!inIFrame) {
        var tabURL = urlPart1 + "/?skipwelcome&q=";
    	if (string !== "") {
            string = string.replace(/ /g, ";");
    		if (string.indexOf("strong=") > -1 || string.indexOf("srchJoin=") > -1
                || string.indexOf("text=") > -1) {
    			tabURL += string;
    		}
    		else {
    			tabURL += "reference=" + string;
    		}

            window.open(tabURL, "_blank");
    	}

    }
    else
    {
    	if (string !== "") {
            string = string.replace(/ /g, ";");
    		window.top.postMessage(string, '*');
    	}
    }
}


function handleKeyboardInput(e) {
	var userInput =  $('textarea#userTextInput').val();
	if ((userInput.slice(-1) === "\n") || (e.originalEvent.inputType === "insertLineBreak")) {
		userInput = userInput.replace(/[\n\r]/g, '').replace(/\t/g, ' ').replace(/\s\s+/g, ' ').replace(/^\s+/g, '');
		$('textarea#userTextInput').val(userInput);
	}
	if ((typeof userInput !== "string") || (userInput.length = 0)) {
		$("tr").show();
	}
	else {
		$("#tb_body").find("tr").hide();
		var re = new RegExp(userInput, "i");
		$("tr").filter(function () { return re.test($(this).find(".tb_col").text());}).show();
	}
}

</script>
</body>
</html>
